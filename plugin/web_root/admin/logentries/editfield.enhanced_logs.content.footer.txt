<script type="text/template" id="validationNumericOperatorsTemplate">
    <option value="greater">Greater than</option>
    <option value="greaterorequal">Greater than or equal to</option>
    <option value="less">Less than</option>
    <option value="lessorequal">Less than or equal to</option>
    <option value="equal">Equal to</option>
    <option value="notequal">Not equal to</option>
    <option value="between">Between</option>
    <option value="notbetween">Not between</option>
</script>

<script type="text/template" id="validationDateTimeOperatorsTemplate">
    <option value="greater">After</option>
    <option value="greaterorequal">On or after</option>
    <option value="less">Before</option>
    <option value="lessorequal">On or before</option>
    <option value="equal">On</option>
    <option value="notequal">Not on</option>
    <option value="between">Between</option>
    <option value="notbetween">Not between</option>
</script>

<script type="text/template" id="adminTemplate">
    <h3 class="toggle aria-toggle collapsed" data-target="adminDefault">
        Default Value
        <span>
            <label>Enable</label>
            <input id="adminEnableDefault"
                   name="[Gen.U_ESLOG_ADMIN_FIELDS]enabledefault"
                   type="checkbox" value="">
        </span>
    </h3>
    <div id="adminDefault" class="hide">
        <table id="adminDefaultOptions" border="0" cellpadding="0" cellspacing="0"
               class="linkDescList">
            <thead>
            <tr>
                <th>Option</th>
                <th style="width: 50%">Value</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td class="bold">Default Value Type</td>
                <td>
                    <select id="adminDefaultType"
                            name="[Gen.U_ESLOG_ADMIN_FIELDS]defaulttype"
                            class="psTextWidget">
                        <option value="none">No default</option>
                        <option value="static">Static value</option>
                        <option value="dynamic">Dynamic value</option>
                    </select>
                    <input id="backupAdminDefaultType" type="hidden">
                </td>
            </tr>
            <tr>
                <td class="bold">Default Value</td>
                <td>
                    <input id="backupAdminStaticDefaultValue" type="hidden">
                    <input id="backupAdminDynamicDefaultValue" type="hidden">
                </td>
            </tr>
            </tbody>
        </table>
    </div>
    <h3 class="toggle aria-toggle collapsed" data-target="adminValidation">
        Validation
        <span>
            <label>Enable</label>
            <input id="adminEnableValidation"
                   name="[Gen.U_ESLOG_ADMIN_FIELDS]enablevalidation"
                   type="checkbox" value="">
        </span>
    </h3>
    <div id="adminValidation" class="hide">
        <table id="adminValidationOptions" border="0" cellpadding="0" cellspacing="0"
               class="linkDescList">
            <thead>
            <tr>
                <th>Option</th>
                <th>Value</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td class="bold">Required Field</td>
                <td>
                    <input id="adminRequiredField"
                           name="[Gen.U_ESLOG_ADMIN_FIELDS]requiredfield"
                           type="checkbox" value="" class="radioSlider">
                </td>
            </tr>
            <tr>
                <td class="bold">Validation Type</td>
                <td>
                    <select id="adminValidationType"
                            name="[Gen.U_ESLOG_ADMIN_FIELDS]validationtype"
                            class="psTextWidget">
                        <option value="none">No validation</option>
                        <option value="numeric">Numeric</option>
                        <option value="date">Date</option>
                        <option value="time">Time</option>
                        <option value="email">Email</option>
                        <option value="phone">Phone</option>
                        <option value="regex">Regular Expression</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td class="bold">Parameters</td>
                <td id="adminValidationParameters">
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</script>

<script type="text/template" id="adminStaticDefaultTemplate">
    <input id="adminStaticDefaultValue"
           name="[Gen.U_ESLOG_ADMIN_FIELDS]defaultvalue"
           type="text" value="" size="40" maxlength="100">
</script>

<script type="text/template" id="adminDynamicDefaultTemplate">
    <select id="adminDynamicDefaultValue"
            name="[Gen.U_ESLOG_ADMIN_FIELDS]defaultvalue"
            class="psTextWidget">
        <option value="placeholder1">Placeholder 1</option>
        <option value="placeholder2">Placeholder 2</option>
        <option value="placeholder3">Placeholder 3</option>
        <option value="placeholder4">Placeholder 4</option>
        <option value="placeholder5">Placeholder 5</option>
    </select>
</script>

<script type="text/template" id="adminRangeValidationTemplate">
    Entered data is&nbsp;
    <select id="adminValidationOperator"
            name="[Gen.U_ESLOG_ADMIN_FIELDS]validationoperator"
            class="psTextWidget">
    </select>&nbsp;
    <input id="adminValidationValue1"
           name="[Gen.U_ESLOG_ADMIN_FIELDS]validationvalue1"
           type="text" value="" size="10" maxlength="100">
    <span id="adminValidationValue2InsertionPoint"></span>
</script>

<script type="text/template" id="adminRangeValidationValue2Template">
    &nbsp;and&nbsp;
    <input id="adminValidationValue2"
           name="[Gen.U_ESLOG_ADMIN_FIELDS]validationvalue2"
           type="text" value="" size="10" maxlength="100">
</script>

<script type="text/template" id="teacherTemplate">
    <h2 class="toggle aria-toggle collapsed" data-target="teacherOptions">
        Teacher Portal
        <span>
            <label>Show on Teacher Portal</label>
            <input id="teacherShowOnPortal"
                   name="[Gen.U_ESLOG_TEACHER_FIELDS]showonportal"
                   type="checkbox" value="">
        </span>
    </h2>
    <div id="teacherOptions" class="hide">
        <table id="teacherFormattingOptions" border="0" cellpadding="0" cellspacing="0"
               class="linkDescList">
            <thead>
            <tr>
                <th>Option</th>
                <th>Value</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td class="bold">Match Admin Portal Formatting</td>
                <td>
                    <input id="teacherMatchAdminFormatting"
                           name="[Gen.U_ESLOG_TEACHER_FIELDS]matchadminformatting"
                           type="checkbox" value="" class="radioSlider">
                    <input id="teacherFormattingBackedUp" type="hidden" value="0">
                </td>
            </tr>
            <tr>
                <td class="bold">Field Label</td>
                <td>
                    <input id="teacherFieldLabel"
                           name="[Gen.U_ESLOG_TEACHER_FIELDS]inputlabel"
                           type="text" value="" size="40">
                    <input id="backupInputLabel" type="hidden">
                </td>
            </tr>
            <tr>
                <td class="bold">Input Type</td>
                <td>
                    <select id="teacherInputType"
                            name="[Gen.U_ESLOG_TEACHER_FIELDS]inputtype"
                            class="psTextWidget">
                        <option value="text">Entry field</option>
                        <option value="static">Static field</option>
                        <option value="checkbox">Checkbox</option>
                        <option value="popup">Popup menu</option>
                        <option value="radio">Radio button</option>
                        <option value="textarea">Entry box</option>
                    </select>
                    <input id="backupInputType" type="hidden">
                </td>
            </tr>
            <tr>
                <td class="bold">Width<br>(applies only to 'entry field' and 'entry box' types)</td>
                <td>
                    <input id="teacherInputWidth"
                           name="[Gen.U_ESLOG_TEACHER_FIELDS]width"
                           type="text" value="" size="2"
                           data-validation="{&quot;minValue&quot;:&quot;-9223372036854775808&quot;,&quot;maxValue&quot;:&quot;9223372036854775807&quot;,&quot;isinteger&quot;:&quot;true&quot;,&quot;type&quot;:&quot;number&quot;,&quot;key&quot;:&quot;gen.valueli&quot;}"
                           class="psNumWidget" data-minvalue="-9223372036854775808"
                           data-maxvalue="9223372036854775807" data-isinteger="true">
                    &nbsp;(width in characters)
                    <input id="backupInputWidth" type="hidden">
                </td>
            </tr>
            <tr>
                <td class="bold">Height<br>(applies only to 'entry box' type)</td>
                <td>
                    <input id="teacherInputHeight"
                           name="[Gen.U_ESLOG_TEACHER_FIELDS]height"
                           type="text" value="" size="2"
                           data-validation="{&quot;minValue&quot;:&quot;-9223372036854775808&quot;,&quot;maxValue&quot;:&quot;9223372036854775807&quot;,&quot;isinteger&quot;:&quot;true&quot;,&quot;type&quot;:&quot;number&quot;,&quot;key&quot;:&quot;gen.valueli2&quot;}"
                           class="psNumWidget" data-minvalue="-9223372036854775808"
                           data-maxvalue="9223372036854775807" data-isinteger="true">
                    &nbsp;(height in lines)
                    <input id="backupInputHeight" type="hidden">
                </td>
            </tr>
            <tr>
                <td class="bold">Data for Popup or Radio buttons<br>(press return after each entry)
                </td>
                <td>
                <textarea id="teacherListEntries"
                          name="[Gen.U_ESLOG_TEACHER_FIELDS]data"
                          rows="11" cols="40"></textarea>
                    <input id="backupData" type="hidden">
                </td>
            </tr>
            </tbody>
        </table>
        <h3 class="toggle aria-toggle collapsed" data-target="teacherDefault">
            Default Value
            <span>
                <label>Enable</label>
                <input id="teacherEnableDefault"
                       type="checkbox" value="">
            </span>
        </h3>
        <div id="teacherDefault" class="hide">
            <table id="teacherDefaultOptions" border="0" cellpadding="0" cellspacing="0"
                   class="linkDescList">
                <thead>
                <tr>
                    <th>Option</th>
                    <th style="width: 50%">Value</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td class="bold">Match Admin Portal Default Value Settings</td>
                    <td>
                        <input id="teacherMatchAdminDefault"
                               name="[Gen.U_ESLOG_TEACHER_FIELDS]matchadmindefault"
                               type="checkbox" value="" class="radioSlider">
                        <input id="teacherDefaultBackedUp" type="hidden" value="0">
                    </td>
                </tr>
                <tr>
                    <td class="bold">Default Value Type</td>
                    <td>
                        <select id="teacherDefaultType"
                                name="[Gen.U_ESLOG_TEACHER_FIELDS]defaulttype"
                                class="psTextWidget">
                            <option value="none">No default</option>
                            <option value="static">Static value</option>
                            <option value="dynamic">Dynamic value</option>
                        </select>
                        <input id="backupTeacherDefaultType" type="hidden">
                    </td>
                </tr>
                <tr>
                    <td class="bold">Default Value</td>
                    <td>
                        <input id="backupTeacherStaticDefaultValue" type="hidden">
                        <input id="backupTeacherDynamicDefaultValue" type="hidden">
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
        <h3 class="toggle aria-toggle collapsed" data-target="teacherValidation">
            Validation
            <span>
                <label>Enable</label>
                <input id="teacherEnableValidation"
                       type="checkbox" value="">
            </span>
        </h3>
        <div id="teacherValidation" class="hide">
            <table id="teacherValidationOptions" border="0" cellpadding="0" cellspacing="0"
                   class="linkDescList">
                <thead>
                <tr>
                    <th>Option</th>
                    <th>Value</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td class="bold">Match Admin Portal Validation Settings</td>
                    <td>
                        <input id="teacherMatchAdminValidation"
                               name="[Gen.U_ESLOG_TEACHER_FIELDS]matchadminvalidation"
                               type="checkbox" value="" class="radioSlider">
                    </td>
                </tr>
                <tr>
                    <td class="bold">Required Field</td>
                    <td>
                        <input id="teacherRequiredField"
                               name="[Gen.U_ESLOG_TEACHER_FIELDS]requiredfield"
                               type="checkbox" value="" class="radioSlider">
                    </td>
                </tr>
                <tr>
                    <td class="bold">Validation Type</td>
                    <td>
                        <select id="teacherValidationType"
                                name="[Gen.U_ESLOG_TEACHER_FIELDS]validationtype"
                                class="psTextWidget">
                            <option value="none">No validation</option>
                            <option value="numeric">Numeric</option>
                            <option value="date">Date</option>
                            <option value="time">Time</option>
                            <option value="email">Email</option>
                            <option value="phone">Phone</option>
                            <option value="regex">Regular Expression</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td class="bold">Parameters</td>
                    <td id="teacherValidationParameters">
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</script>

<script type="text/template" id="teacherStaticDefaultTemplate">
    <input id="teacherStaticDefaultValue"
           name="[Gen.U_ESLOG_TEACHER_FIELDS]defaultvalue"
           type="text" value="" size="40" maxlength="100">
</script>

<script type="text/template" id="teacherDynamicDefaultTemplate">
    <select id="teacherDynamicDefaultValue"
            name="[Gen.U_ESLOG_TEACHER_FIELDS]defaultvalue"
            class="psTextWidget">
        <option value="placeholder1">Placeholder 1</option>
        <option value="placeholder2">Placeholder 2</option>
        <option value="placeholder3">Placeholder 3</option>
        <option value="placeholder4">Placeholder 4</option>
        <option value="placeholder5">Placeholder 5</option>
    </select>
</script>

<script type="text/template" id="teacherRangeValidationTemplate">
    Entered data is&nbsp;
    <select id="teacherValidationOperator"
            name="[Gen.U_ESLOG_TEACHER_FIELDS]validationoperator"
            class="psTextWidget">
    </select>&nbsp;
    <input id="teacherValidationValue1"
           name="[Gen.U_ESLOG_TEACHER_FIELDS]validationvalue1"
           type="text" value="" size="10" maxlength="100">
    <span id="teacherValidationValue2InsertionPoint"></span>
</script>

<script type="text/template" id="teacherRangeValidationValue2Template">
    &nbsp;and&nbsp;
    <input id="teacherValidationValue2"
           name="[Gen.U_ESLOG_TEACHER_FIELDS]validationvalue2"
           type="text" value="" size="10" maxlength="100">
</script>

<script>
    function backupTeacherFormattingVals()
    {
        if ($j('#teacherFormattingBackedUp').val() === '0')
        {
            $j('#backupInputLabel').val($j('#teacherFieldLabel').val());
            $j('#backupInputType').val($j('#teacherInputType').val());
            $j('#backupInputWidth').val($j('#teacherInputWidth').val());
            $j('#backupInputHeight').val($j('#teacherInputHeight').val());
            $j('#backupData').val($j('#teacherListEntries').val());

            $j('#teacherFormattingBackedUp').val('1');
        }
    }

    function restoreTeacherFormattingVals()
    {
        $j('#teacherFieldLabel').val($j('#backupInputLabel').val());
        $j('#teacherInputType').val($j('#backupInputType').val());
        $j('#teacherInputWidth').val($j('#backupInputWidth').val());
        $j('#teacherInputHeight').val($j('#backupInputHeight').val());
        $j('#teacherListEntries').val($j('#backupData').val());
    }

    function clearTeacherFormattingVals()
    {
        $j('#teacherFieldLabel').val('');
        $j('#teacherInputType').val('text');
        $j('#teacherInputWidth').val('');
        $j('#teacherInputHeight').val('');
        $j('#teacherListEntries').val('');
    }

    function backupTeacherDefaultVals()
    {
        $j('#backupTeacherDefaultType').val($j('#teacherDefaultType').val());
        $j('#backupTeacherStaticDefaultValue').val($j('#teacherStaticDefaultValue').val());
        $j('#backupTeacherDynamicDefaultValue').val($j('#teacherDynamicDefaultValue').val());
    }

    function restoreTeacherDefaultVals()
    {
        $j('#teacherDefaultType').val($j('#backupTeacherDefaultType').val());
        swapTeacherDefaultType();
        $j('#teacherStaticDefaultValue').val($j('#backupTeacherStaticDefaultValue').val());
        $j('#teacherDynamicDefaultValue').val($j('#backupTeacherDynamicDefaultValue').val());
    }

    function clearTeacherDefaultVals()
    {
        $j('#teacherDefaultType').val('none');
        swapTeacherDefaultType();
    }

    function enableFields(container_selector, fields_selector, exclude_selector = '')
    {
        if (exclude_selector !== '')
        {
            $j(container_selector).find(fields_selector)
                                  .not(exclude_selector)
                                  .removeAttr('disabled');
        }
        else
        {
            $j(container_selector).find(fields_selector)
                                  .removeAttr('disabled');
        }
    }

    function disableFields(container_selector, fields_selector, exclude_selector = '')
    {
        if (exclude_selector !== '')
        {
            $j(container_selector).find(fields_selector)
                                  .not(exclude_selector)
                                  .attr('disabled', 'disabled');
        }
        else
        {
            $j(container_selector).find(fields_selector)
                                  .attr('disabled', 'disabled');
        }
    }

    function setupEventHandlers()
    {
        $j('#teacherShowOnPortal').on('change', showOnPortalChange);

        $j('#teacherMatchAdminFormatting').on('change', matchAdminFormattingChange);
        $j('#teacherFormattingOptions').find('input, select, textarea')
                                       .not('#teacherShowOnPortal, ' +
                                            '#teacherMatchAdminFormatting, :hidden')
                                       .on('change', teacherFormattingFieldChange);

        $j('#teacherMatchAdminDefault').on('change', matchAdminDefaultChange);
        $j('#teacherDefaultType').on('change', teacherDefaultTypeChange);
        $j('#teacherStaticDefaultValue').on('change', teacherStaticDefaultChange);
        $j('#teacherDynamicDefaultValue').on('change', teacherDynamicDefaultChange);
    }

    function showOnPortalChange()
    {
        if ($j('#teacherShowOnPortal').is(':checked'))
        {
            if ($j('#teacherMatchAdminFormatting').is(':checked'))
            {
                $j('#teacherMatchAdminFormatting').removeAttr('disabled');
            }
            else
            {
                // enableFields('#teacherFormattingOptions', 'input, select, textarea');
                // restoreTeacherFormattingVals();

                matchAdminFormattingChange();
            }

            if ($j('#teacherMatchAdminDefault').is(':checked'))
            {
                $j('#teacherMatchAdminDefault').removeAttr('disabled');
            }
            else
            {
                // enableFields('#teacherDefaultOptions', 'input, select, textarea');
                // restoreTeacherDefaultVals();

                matchAdminDefaultChange();
            }
        }
        else
        {
            disableFields('#teacherFormattingOptions', 'input, select, textarea',
                          '#teacherShowOnPortal, :hidden');
            disableFields('#teacherDefaultOptions', 'input, select, textarea', ':hidden');

            backupTeacherFormattingVals();
            clearTeacherFormattingVals();

            // backupTeacherDefaultVals();
            clearTeacherDefaultVals();
        }
    }

    function matchAdminFormattingChange()
    {
        if ($j('#teacherMatchAdminFormatting').is(':checked'))
        {
            disableFields('#teacherFormattingOptions', 'input, select, textarea',
                          '#teacherShowOnPortal, #teacherMatchAdminFormatting, :hidden');
            backupTeacherFormattingVals();
            clearTeacherFormattingVals();
        }
        else if ($j('#teacherShowOnPortal').is(':checked'))
        {
            enableFields('#teacherFormattingOptions', 'input, select, textarea',
                         '#teacherShowOnPortal, #teacherMatchAdminFormatting, :hidden');
            restoreTeacherFormattingVals();
        }
    }

    function teacherFormattingFieldChange()
    {
        $j('#teacherFormattingBackedUp').val('0');
    }

    function matchAdminDefaultChange()
    {
        if ($j('#teacherMatchAdminDefault').is(':checked'))
        {
            disableFields('#teacherDefaultOptions', 'input, select, textarea',
                          '#teacherMatchAdminDefault, :hidden');
            // backupTeacherDefaultVals();
            clearTeacherDefaultVals();
        }
        else if ($j('#teacherShowOnPortal').is(':checked'))
        {
            enableFields('#teacherDefaultOptions', 'input, select, textarea',
                         '#teacherMatchAdminDefault, :hidden');
            restoreTeacherDefaultVals();
        }
    }

    function teacherDefaultTypeChange()
    {
        $j('#backupTeacherDefaultType').val($j('#teacherDefaultType').val());

        restoreTeacherDefaultVals();
    }

    function swapTeacherDefaultType()
    {
        switch ($j('#teacherDefaultType').val())
        {
            case 'none':
                $j('#teacherStaticDefaultValue').remove();
                $j('#teacherDynamicDefaultValue').remove();
                break;

            case 'static':
                $j('#teacherDynamicDefaultValue').remove();
                $j('#backupTeacherStaticDefaultValue')
                    .before($j('#teacherStaticDefaultTemplate').html());
                $j('#teacherStaticDefaultValue').on('change', teacherStaticDefaultChange);
                break;

            case 'dynamic':
                $j('#teacherStaticDefaultValue').remove();
                $j('#backupTeacherDynamicDefaultValue')
                    .before($j('#teacherDynamicDefaultTemplate').html());
                $j('#teacherDynamicDefaultValue').on('change', teacherDynamicDefaultChange);
                break;
        }
    }

    function teacherStaticDefaultChange()
    {
        $j('#backupTeacherStaticDefaultValue').val($j('#teacherStaticDefaultValue').val());
    }

    function teacherDynamicDefaultChange()
    {
        $j('#backupTeacherDynamicDefaultValue').val($j('#teacherDynamicDefaultValue').val());
    }

    (function ()
    {
        let adminContent = $j('#adminTemplate').html();
        let teacherContent = $j('#teacherTemplate').html();
        let target = $j('.box-round table');

        target.wrap('<div id="adminOptions" class="box-round"></div>');

        let adminOptions = $j('#adminOptions');

        adminOptions.prepend('<h2>Admin Portal</h2>');
        adminOptions.append(adminContent);
        adminOptions.after(teacherContent);

        // backupTeacherFormattingVals();
        // backupTeacherDefaultVals();

        showOnPortalChange();
        // matchAdminFormattingChange();
        // matchAdminDefaultChange();

        setupEventHandlers();
    })();
</script>